<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatooly CDN Test - DOM Elements</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
        }
        #chatooly-canvas {
            width: calc(100vw - 40px);
            height: calc(100vh - 200px);
            margin: 20px auto;
            border: 2px solid #ddd;
            background: #fff;
            border-radius: 8px;
            position: relative;
            overflow: auto;
        }
        
        #app {
            max-width: 600px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .gradient-box {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .control-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="range"] {
            width: 100%;
            margin: 5px 0;
        }
        .value-display {
            text-align: center;
            font-size: 18px;
            color: #333;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <h1>Chatooly CDN Test - DOM Elements</h1>
    <p>This page tests the Chatooly export functionality with DOM elements (no canvas).</p>
    
    <div style="background: #e9ecef; padding: 15px; border-radius: 8px; margin: 20px 0;">
        <strong>CDN Version:</strong>
        <label style="margin: 0 10px;">
            <input type="radio" name="version" value="full" checked onchange="switchVersion(this.value)"> 
            Full (18KB)
        </label>
        <label style="margin: 0 10px;">
            <input type="radio" name="version" value="min" onchange="switchVersion(this.value)"> 
            Minified (7.9KB)
        </label>
        <span id="current-version" style="margin-left: 20px; font-weight: bold; color: #007bff;">Using: Full</span>
    </div>
    
    <div id="chatooly-canvas">
        <div id="app">
        <h2>Interactive Gradient Tool</h2>
        <p>Adjust the controls below to modify the gradient, then export as PNG.</p>
        
        <div class="gradient-box" id="gradient-display">
            Gradient Preview
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="hue1">Color 1 Hue</label>
                <input type="range" id="hue1" min="0" max="360" value="0">
                <div class="value-display" id="hue1-value">0°</div>
            </div>
            
            <div class="control-group">
                <label for="hue2">Color 2 Hue</label>
                <input type="range" id="hue2" min="0" max="360" value="180">
                <div class="value-display" id="hue2-value">180°</div>
            </div>
            
            <div class="control-group">
                <label for="angle">Gradient Angle</label>
                <input type="range" id="angle" min="0" max="360" value="45">
                <div class="value-display" id="angle-value">45°</div>
            </div>
            
            <div class="control-group">
                <label for="saturation">Saturation</label>
                <input type="range" id="saturation" min="0" max="100" value="70">
                <div class="value-display" id="saturation-value">70%</div>
            </div>
        </div>
        
        <p><strong>Instructions:</strong></p>
        <ul>
            <li>Adjust the sliders to create your gradient</li>
            <li>Use the floating export button to save as PNG</li>
            <li>This tests DOM-based export (html2canvas fallback)</li>
        </ul>
        </div>
    </div>

    <!-- Chatooly CDN - Dynamic Loading with CSS -->
    <script id="chatooly-script" src="../js/core.min.js"></script>
    
    <!-- Version Switching Logic -->
    <script>
        function switchVersion(version) {
            const oldScript = document.getElementById('chatooly-script');
            const newScript = document.createElement('script');
            
            newScript.id = 'chatooly-script';
            newScript.src = version === 'min' ? '../js/core.min.js' : '../js/core.js';
            
            // Update status
            document.getElementById('current-version').textContent = 
                `Using: ${version === 'min' ? 'Minified (7.9KB)' : 'Full (18KB)'}`;
            
            // Replace script and reload
            oldScript.parentNode.insertBefore(newScript, oldScript);
            oldScript.remove();
            
            newScript.onload = () => {
                // Reinitialize Chatooly
                if (window.Chatooly) {
                    window.Chatooly.init(window.ChatoolyConfig);
                    console.log(`Switched to ${version === 'min' ? 'minified' : 'full'} version`);
                }
            };
        }
    </script>
    
    <!-- Tool Configuration -->
    <script>
        window.ChatoolyConfig = {
            name: "DOM Gradient Tool",
            resolution: 2,
            enableCanvasArea: false // DOM export doesn't need canvas area
        };
    </script>
    
    <!-- Tool Logic -->
    <script>
        const gradientDisplay = document.getElementById('gradient-display');
        const hue1Slider = document.getElementById('hue1');
        const hue2Slider = document.getElementById('hue2');
        const angleSlider = document.getElementById('angle');
        const saturationSlider = document.getElementById('saturation');
        
        function updateGradient() {
            const hue1 = hue1Slider.value;
            const hue2 = hue2Slider.value;
            const angle = angleSlider.value;
            const saturation = saturationSlider.value;
            
            const color1 = `hsl(${hue1}, ${saturation}%, 60%)`;
            const color2 = `hsl(${hue2}, ${saturation}%, 60%)`;
            
            gradientDisplay.style.background = `linear-gradient(${angle}deg, ${color1}, ${color2})`;
            
            // Update value displays
            document.getElementById('hue1-value').textContent = hue1 + '°';
            document.getElementById('hue2-value').textContent = hue2 + '°';
            document.getElementById('angle-value').textContent = angle + '°';
            document.getElementById('saturation-value').textContent = saturation + '%';
        }
        
        // Add event listeners
        [hue1Slider, hue2Slider, angleSlider, saturationSlider].forEach(slider => {
            slider.addEventListener('input', updateGradient);
        });
        
        // Initialize
        updateGradient();
    </script>
</body>
</html>